{"remainingRequest":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dev\\high-concurrency\\high-concurrency\\src\\views\\login\\Login.vue?vue&type=style&index=0&id=2529d779&lang=scss&scoped=true&","dependencies":[{"path":"D:\\dev\\high-concurrency\\high-concurrency\\src\\views\\login\\Login.vue","mtime":1617443318412},{"path":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dev\\high-concurrency\\high-concurrency\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5iZyB7DQogIGJhY2tncm91bmQtaW1hZ2U6IHVybCgiLi4vLi4vYXNzZXRzL2ltYWdlcy9sb2dpbi1iZy5qcGciKTsNCiAgYmFja2dyb3VuZC1zaXplOiAxMDAlIDEwMCU7DQogIC8vIG9wYWNpdHk6IDAuODsNCiAgLmxvZ2luLWZvcm0gew0KICAgIHotaW5kZXg6IDEwMDsNCiAgfQ0KfQ0KLnRpdGxlIHsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBmb250LXdlaWdodDogMzAwOw0KICBmb250LXNpemU6IDMuNzVyZW07DQp9DQoNCi5tYXNrIHsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICB0b3A6IDA7DQogIGJvdHRvbTogMDsNCiAgbGVmdDogMDsNCiAgcmlnaHQ6IDA7DQogIC8vYmFja2dyb3VuZC1pbWFnZTogbGluZWFyLWdyYWRpZW50KHRvIHJpZ2h0LCAjMTQ0NzVmIDAlLCAjNjQ4MmFmIDUwJSk7DQogIG9wYWNpdHk6IDAuMzsNCn0NCg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\r\n  <v-app class=\"bg\">\r\n    <div class=\"title text-h3 mt-6 font-weight-thin\" tile>骸冰商城</div>\r\n    <v-content>\r\n      <v-container class=\"fill-height\" fluid>\r\n        <v-row align=\"center\" justify=\"center\" class=\"login-form\">\r\n          <v-col cols=\"12\" sm=\"8\" md=\"4\">\r\n            <v-card class=\"elevation-8\">\r\n              <v-toolbar color=\"teal lighten-1\" dark flat>\r\n                <v-toolbar-title v-if=\"loginNum !== 2\"\r\n                  >{{ loginNum === 0 ? \"账号密码登录\" : \"手机验证码登录\" }}\r\n                </v-toolbar-title>\r\n                <v-toolbar-title v-else>注册</v-toolbar-title>\r\n                <v-spacer />\r\n                <v-tooltip bottom>\r\n                  <template v-slot:activator=\"{ on }\">\r\n                    <v-btn :href=\"source\" icon large target=\"_blank\" v-on=\"on\">\r\n                      <v-icon>mdi-code-tags</v-icon>\r\n                    </v-btn>\r\n                  </template>\r\n                  <span>Source</span>\r\n                </v-tooltip>\r\n              </v-toolbar>\r\n              <v-card-text>\r\n                <v-form v-if=\"loginNum === 0\" :model=\"validateForm\">\r\n                  <v-text-field\r\n                    id=\"name\"\r\n                    label=\"用户名\"\r\n                    name=\"name\"\r\n                    type=\"text\"\r\n                    v-model=\"validateForm.username\"\r\n                  />\r\n                  <v-text-field\r\n                    id=\"password\"\r\n                    label=\"密码\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    v-model=\"validateForm.password\"\r\n                  />\r\n                </v-form>\r\n                <v-form v-else :model=\"validateForm\">\r\n                  <v-text-field\r\n                    id=\"name\"\r\n                    label=\"手机号\"\r\n                    name=\"name\"\r\n                    type=\"phone\"\r\n                    v-model=\"validateForm.phone\"\r\n                  />\r\n\r\n                  <v-text-field\r\n                    id=\"password\"\r\n                    label=\"验证码\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    v-model=\"validateForm.code\"\r\n                  >\r\n                  </v-text-field>\r\n                  <p v-if=\"!send\" @click=\"sendCode()\">发送验证码</p>\r\n                  <p v-else>还剩{{ time }}s</p>\r\n                </v-form>\r\n                <div @click=\"changeLogin()\">\r\n                  {{ loginNum === 1 ? \"账号密码登录\" : \"手机验证码登录\" }}\r\n                </div>\r\n                <div\r\n                  v-if=\"loginNum !== 2\"\r\n                  @click=\"changeRes()\"\r\n                  style=\"margin-top: 10px\"\r\n                >\r\n                  注册\r\n                </div>\r\n              </v-card-text>\r\n              <v-card-actions>\r\n                <v-spacer />\r\n                <v-btn @click=\"submit\" color=\"teal lighten-1\">{{\r\n                  loginNum === 2 ? \"Resgister\" : \"Login\"\r\n                }}</v-btn>\r\n              </v-card-actions>\r\n            </v-card>\r\n          </v-col>\r\n        </v-row>\r\n      </v-container>\r\n    </v-content>\r\n    <div class=\"mask\"></div>\r\n  </v-app>\r\n</template>\r\n\r\n<script>\r\nconst API = require(\"../../utils/request.js\")\r\nexport default {\r\n  name: \"Login\",\r\n  data() {\r\n    return {\r\n      usernameRules: [\r\n        { validate: (val) => !!val, message: \"必须填写用户名\" },\r\n        { validate: (val) => val.length >= 3, message: \"用户名长度大于3\" },\r\n      ],\r\n      passwordRules: [\r\n        { validate: (val) => !!val, message: \"必须填写密码\" },\r\n        {\r\n          validate: (val) => val.length >= 3 && val.length <= 10,\r\n          message: \"密码长度大于3小于10\",\r\n        },\r\n      ],\r\n      phoneRules: [\r\n        { validate: (val) => !!val, message: \"必须填写手机号\" },\r\n        {\r\n          validate: (val) => val.test(/^1[34578]\\d{9}$/),\r\n          message: \"手机号格式不正确\",\r\n        },\r\n      ],\r\n      codeRules: [\r\n        { validate: (val) => !!val, message: \"必须填写验证码\" },\r\n        {\r\n          validate: (val) => val.length == 5,\r\n          message: \"验证码必须为6位\",\r\n        },\r\n      ],\r\n      validateForm: {\r\n        username: \"ntt\",\r\n        password: \"123\",\r\n        phone: \"\",\r\n        code: \"\",\r\n      },\r\n      loginNum: 0,\r\n      send: false,\r\n      time: 60,\r\n    };\r\n  },\r\n  props: {\r\n    source: String,\r\n  },\r\n  methods: {\r\n    async submit() {\r\n      if (this.loginNum === 0) {\r\n        //表单验证\r\n\r\n          this.url = this.GLOBAL.baseUrl + \"/user/login\",\r\n          this.data= {\r\n            username: this.validateForm.username,\r\n            password: this.validateForm.password,\r\n          },\r\n          this.result = await API.init(this.url,this.data,\"post\")\r\n          //登录成功\r\n          console.log(\"登录成功\")\r\n          console.log(this.result);\r\n          if (this.result.code === 1) {\r\n            //存入token\r\n            localStorage.setItem(\"token\", this.result.data.token);\r\n            localStorage.setItem(\"user\", this.result.data.user);\r\n            localStorage.setItem(\"userId\", this.result.data.user.pkUserId);\r\n            localStorage.setItem(\"avatar\", this.result.data.user.avatar);\r\n            this.$store.commit(\"setToken\", this.result.data.token);\r\n            this.$router.push(\"/\");\r\n          }\r\n\r\n      } else if (this.loginNum === 1) {\r\n          this.url= this.GLOBAL.baseUrl + \"/user/code/login\",\r\n          this.data={\r\n            phoneNumber: this.validateForm.phone,\r\n            verifyCode: this.validateForm.code,\r\n          },\r\n          this.result = await API.init(this.url,this.data,\"post\")\r\n          if (this.result.code === 1) {\r\n            //存入token\r\n            localStorage.setItem(\"token\", this.result.data.token);\r\n            localStorage.setItem(\"user\", this.result.data.user);\r\n            localStorage.setItem(\"userId\", this.result.data.user.pkUserId);\r\n            localStorage.setItem(\"avatar\", this.result.data.user.avatar);\r\n            this.$store.commit(\"setToken\", this.result.data.token);\r\n            this.$router.push(\"/\");\r\n          }\r\n       \r\n      } else {\r\n \r\n          this.url=this.GLOBAL.baseUrl + \"/user/register\",\r\n          this.data= {\r\n            address: \"\",\r\n            avatar: \"\",\r\n            birthday: \"\",\r\n            code: this.validateForm.code,\r\n            email: \"\",\r\n            nickname: this.validateForm.phone,\r\n            password: this.validateForm.phone,\r\n            phone: this.validateForm.phone,\r\n            sex: 0,\r\n            username: \"\",\r\n          },\r\n         this.result = await API.init(this.url,this.data,\"post\")\r\n          alert(\"注册成功\")\r\n          this.loginNum = 0\r\n      }\r\n    },\r\n    changeLogin() {\r\n      if (this.loginNum === 0) {\r\n        this.loginNum = 1;\r\n      } else {\r\n        this.loginNum = 0;\r\n      }\r\n    },\r\n    changeRes() {\r\n      this.loginNum = 2;\r\n    },\r\n    async sendCode() {\r\n      //手机号正则\r\n      var mPattern = /^1[34578]\\d{9}$/;\r\n      if (!mPattern.test(this.validateForm.phone)) {\r\n        alert(\"手机号格式不正确\");\r\n      } else {\r\n   \r\n          this.url= this.GLOBAL.baseUrl + \"/sendCode\",\r\n          this.data= {\r\n            phoneNumber: this.validateForm.phone,\r\n          },\r\n        this.result = await API.init(this.url,this.data,\"post\")\r\n          this.send = true;\r\n          // 倒计时60s结束后 可再次发送验证码\r\n          let promise = new Promise((resolve, reject) => {\r\n            let setTimer = setInterval(() => {\r\n              this.time = this.time - 1;\r\n              if (this.time <= 0) {\r\n                this.send = false;\r\n                resolve(setTimer);\r\n                this.time = 60;\r\n              }\r\n            }, 1000);\r\n          });\r\n          promise.then((setTimer) => {\r\n            clearInterval(setTimer);\r\n          });\r\n      \r\n      }\r\n    },\r\n  },\r\n  computed: {},\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.bg {\r\n  background-image: url(\"../../assets/images/login-bg.jpg\");\r\n  background-size: 100% 100%;\r\n  // opacity: 0.8;\r\n  .login-form {\r\n    z-index: 100;\r\n  }\r\n}\r\n.title {\r\n  text-align: center;\r\n  font-weight: 300;\r\n  font-size: 3.75rem;\r\n}\r\n\r\n.mask {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  //background-image: linear-gradient(to right, #14475f 0%, #6482af 50%);\r\n  opacity: 0.3;\r\n}\r\n</style>\r\n"]}]}